<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title></title>
<style>
/* ===== ë² ì´ìŠ¤ / ë ˆì´ì•„ì›ƒ ìµœì†Œí™” ===== */
*{box-sizing:border-box}
html,body{margin:0;padding:0}
.new-dwwr{max-width:100%;background:#fff;}

/* ìŠ¤í¬ë¡¤ ë·°í¬íŠ¸ */
#vp{
  height:100dvh; max-height:100dvh;
  height:100svh; max-height:100svh;
  overflow-y:auto;
  overscroll-behavior-y:contain;
  -webkit-overflow-scrolling:touch;
  scroll-snap-type:y proximity;
  scroll-padding-top:env(safe-area-inset-top,0);
  padding-top:env(safe-area-inset-top,0);
  padding-bottom:calc(env(safe-area-inset-bottom,0)+8px);
  touch-action:pan-y;
}

/* ===== ì›” ë¸”ë¡ ===== */
.new-dw-cal-slide{
  background:#fff;
  padding:16px 14px 14px;
  position:relative;
  scroll-margin-top:16px;
}
.new-dw-cal-slide{scroll-snap-align:start}

/* ì›” ì œëª© */
.new-m-title{
  display:flex;align-items:center;justify-content:center;
  gap:6px;margin:6px 0 14px;
  font-weight:500;font-size:16px;color:#111;
}

/* ìš”ì¼ */
.new-dow{
  display:grid;grid-template-columns:repeat(7,1fr);gap:8px;margin:0 0 8px;
}
.new-dow div{text-align:center;font-size:14px;font-weight:500;color:#666;}
.new-dow div.new-sun{color:#ED3437}

/* ë‚ ì§œ ê·¸ë¦¬ë“œ */
.new-dw-cal-row{
  display:grid;grid-template-columns:repeat(7,1fr);gap:8px;
  margin:18px -4px 0;padding:0 4px;
}

/* ë‚ ì§œ ì…€ */
.new-dw-cal-day{
  position:relative;min-height:32px;border-radius:12px;
  display:flex;align-items:center;justify-content:center;user-select:none;
}
.new-dw-cal-day.new-empty{opacity:0;pointer-events:none}
.new-dw-cal-day .new-dw-i{position:relative;z-index:3}
.new-dw-cal-day .new-dw-cal-day-fg{font-size:15px;font-weight:500;color:#333;position:relative;z-index:4;}
.new-dw-cal-day.new-sun .new-dw-cal-day-fg{color:#ef4444}

/* ì˜¤ëŠ˜ ë‚ ì§œ(ë™ê·¸ë¼ë¯¸) */
.new-dw-cal-day.new-dw-cal-today .new-dw-cal-day-fg:before{
  content:"";position:absolute;left:50%;top:50%;
  width:34px;height:34px;border-radius:50%;
  border:1px solid #cfd5db;transform:translate(-50%,-50%);
  z-index:2;
}
.new-dw-cal-day .new-today-tag{
  position:absolute;left:50%;bottom:-17px;
  transform:translateX(-50%);
  font-size:11px;color:#98a1ab;z-index:3;
}

/* ë²”ìœ„ ë  & ì„ íƒ ìº¡ìŠ */
:root{ --band:#dfeafe; --band-ink:#2D4A9B; }

.new-dw-cal-day .new-range-bg{
  position:absolute;z-index:1;left:0;right:0;top:6px;bottom:6px;
  background:var(--band);display:none;
}
.new-dw-cal-day.new-in-range .new-range-bg{
  display:block;top:0;bottom:0;left:-6px;right:-6px;
}

.new-dw-cal-day.new-is-start .new-cap,
.new-dw-cal-day.new-is-end .new-cap{
  display:block;position:absolute;z-index:2;top:0;bottom:0;left:0;right:0;
  border-radius:999px;background:var(--band-ink);
}
.new-dw-cal-day.new-is-start .new-dw-cal-day-fg,
.new-dw-cal-day.new-is-end  .new-dw-cal-day-fg{color:#fff;z-index:3;}

/* ì˜¤ëŠ˜ì„ ì„ íƒí•œ ê²½ìš° ë™ê·¸ë¼ë¯¸ ìˆ¨ê¹€(ì„ íƒ ìƒ‰ìƒì´ ìœ„ì— ì˜¤ë„ë¡) */
.new-dw-cal-day.new-dw-cal-today.new-is-start .new-dw-cal-day-fg:before,
.new-dw-cal-day.new-dw-cal-today.new-is-end   .new-dw-cal-day-fg:before{display:none}

/* ë²”ìœ„ì˜ ì–‘ë ì—°ê²°ê° */
.new-dw-cal-day.new-range-left .new-range-bg:before,
.new-dw-cal-day.new-range-right .new-range-bg:after{
  content:"";position:absolute;top:0;bottom:0;width:20px;
}
.new-dw-cal-day.new-range-left .new-range-bg:before{
  left:-20px;background:linear-gradient(90deg,rgba(223,234,254,0),var(--band));
}
.new-dw-cal-day.new-range-right .new-range-bg:after{
  right:-20px;background:linear-gradient(270deg,rgba(223,234,254,0),var(--band));
}

/* ì´ë²ˆë‹¬ì˜ 'ì˜¤ëŠ˜ ì´ì „' íšŒìƒ‰ ì²˜ë¦¬ */
.new-dw-cal-day.new-past .new-dw-cal-day-fg { color:#999; }
</style>
</head>
<body>

<div class="new-dwwr">
  <!-- ìŠ¤í¬ë¡¤ ë·°í¬íŠ¸ -->
  <div id="vp">
    <!-- ì›”ë“¤ì´ ìŒ“ì´ëŠ” ê³³ -->
    <div id="yearContainer"></div>
  </div>
</div>

<script>
(() => {
  /* ===== ë‚ ì§œ ìœ í‹¸ ===== */
  const today = new Date();
  const Y0 = today.getFullYear();
  const M0 = today.getMonth(); // 0~11
  const iso = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
  const todayISO = iso(today);
  const noonStamp = d => new Date(d.getFullYear(), d.getMonth(), d.getDate(), 12).getTime();
  const daysIn = (y,m) => new Date(y, m+1, 0).getDate();

  /* ===== ìƒíƒœ & ê¸°ë³¸ ë…¸ë“œ ===== */
  const S = { start:null, end:null, maxYear:null };
  const vp  = document.getElementById('vp');
  const box = document.getElementById('yearContainer');

  /* ===== DOM í—¬í¼ ===== */
  const div = cls => { const x=document.createElement('div'); if(cls) x.className=cls; return x; };
  const title = t => { const x=div('new-m-title'); x.textContent=t; return x; };
  const dow = () => {
    const x=div('new-dow');
    x.innerHTML = '<div class="new-sun">ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>';
    return x;
  };

  /* ===== í•œ ë‹¬ ìƒì„± ===== */
  function makeMonth(y,m){
    const wrap = div('new-dw-cal-slide');
    wrap.dataset.ym = `${y}-${m+1}`;
    wrap.appendChild(title(`${y}ë…„ ${m+1}ì›”`));
    wrap.appendChild(dow());

    const firstDow = new Date(y,m,1).getDay();
    const lastDay  = daysIn(y,m);
    const isThisMonth = (y===Y0 && m===M0);

    let day = 1;
    for(let r=0;r<6;r++){
      const row = div('new-dw-cal-row');
      for(let c=0;c<7;c++){
        const idx = r*7+c;
        const cell = div('new-dw-cal-day');

        if(r===0 && idx<firstDow){ cell.classList.add('new-empty'); row.appendChild(cell); continue; }
        if(day>lastDay){ cell.classList.add('new-empty'); row.appendChild(cell); continue; }

        const dObj = new Date(y,m,day);
        const ds   = iso(dObj);

        if(dObj.getDay()===0) cell.classList.add('new-sun');
        if(ds===todayISO)     cell.classList.add('new-dw-cal-today');

        // ì´ë²ˆë‹¬ì˜ 'ì˜¤ëŠ˜ ì´ì „'ì€ íšŒìƒ‰ + í´ë¦­ ë¶ˆê°€
        const isPast = isThisMonth && ds < todayISO;
        if(isPast) cell.classList.add('new-past');

        cell.dataset.date = ds;
        cell.innerHTML = `
          <div class="new-range-bg"></div>
          <div class="new-cap" style="display:none"></div>
          <div class="new-dw-i"><div class="new-dw-cal-day-fg">${day}</div></div>
          ${ds===todayISO ? '<div class="new-today-tag">ì˜¤ëŠ˜</div>' : ''}
        `;

        if(!isPast){
          cell.addEventListener('click', () => {
            console.log('ğŸ“… í´ë¦­:', ds);
            pick(dObj);
          });
        }

        row.appendChild(cell);
        day++;
      }
      wrap.appendChild(row);
      if(day>lastDay) break;
    }
    return wrap;
  }

  /* ===== íŠ¹ì • ì—°ë„ì˜ monthStartë¶€í„° 12ì›”ê¹Œì§€ ì¶”ê°€ ===== */
  function addYearFrom(y, monthStart=0){
    const frag=document.createDocumentFragment();
    for(let m=monthStart;m<12;m++) frag.appendChild(makeMonth(y,m));
    box.appendChild(frag);
  }

  /* ===== ì„ íƒ ë¡œì§ ===== */
  function pick(d){
    if(!S.start || S.end){ S.start=d; S.end=null; }
    else { S.end=(d<S.start)?S.start:d; S.start=(d<S.start)?d:S.start; }
    paint();
  }

  /* ===== ì¹ í•˜ê¸° ===== */
  function paint(){
    const cells=box.querySelectorAll('.new-dw-cal-day');
    // reset
    cells.forEach(c=>{
      c.classList.remove('new-in-range','new-is-start','new-is-end','new-range-left','new-range-right');
      const cap=c.querySelector('.new-cap'); if(cap) cap.style.display='none';
      const tag=c.querySelector('.new-today-tag'); if(tag) tag.style.display='';
    });

    // ì˜¤ëŠ˜ íƒœê·¸ ìœ ì§€
    const todayCell=box.querySelector(`.new-dw-cal-day[data-date="${todayISO}"]`);
    if(todayCell){
      todayCell.classList.add('new-dw-cal-today');
      const tag=todayCell.querySelector('.new-today-tag'); if(tag) tag.style.display='';
    }

    if(!S.start && !S.end) return;

    const A=noonStamp(S.start);
    const B=S.end?noonStamp(S.end):null;

    cells.forEach(c=>{
      const ds=c.dataset.date;
      if(!ds || c.classList.contains('new-empty') || c.classList.contains('new-past')) return;

      const [yy,mm,dd]=ds.split('-').map(Number);
      const t=noonStamp(new Date(yy,mm-1,dd));

      if(t===A){
        c.classList.add('new-is-start');
        c.querySelector('.new-cap').style.display='block';
      } else if(B!==null && t===B){
        c.classList.add('new-is-end');
        c.querySelector('.new-cap').style.display='block';
      } else if(B!==null && t>A && t<B){
        c.classList.add('new-in-range');
      }

      if(c.classList.contains('new-in-range')){
        const row=c.parentElement;
        const i=Array.prototype.indexOf.call(row.children,c);
        const L=row.children[i-1], R=row.children[i+1];
        if(!(L&&L.classList.contains('new-in-range'))) c.classList.add('new-range-left');
        if(!(R&&R.classList.contains('new-in-range'))) c.classList.add('new-range-right');
      }
    });
  }

  /* ===== ì´ˆê¸° ë Œë” + ë¬´í•œ ìŠ¤í¬ë¡¤(ì•„ë˜ìª½) ===== */
  function init(){
    addYearFrom(Y0, M0);               // ì˜¬í•´: ì´ë²ˆ ë‹¬ë¶€í„° 12ì›”ê¹Œì§€
    S.maxYear = Y0;
    paint();

    const cur=box.querySelector(`[data-ym="${Y0}-${M0+1}"]`)||box.firstElementChild;
    if(cur) cur.scrollIntoView({behavior:'instant',block:'start'});

    // ì•„ë˜ë¡œ í•œ í•´ ë¯¸ë¦¬
    appendNextYear();
  }

  function appendNextYear(){
    const y=S.maxYear+1;
    addYearFrom(y,0);
    S.maxYear=y;
    paint();
  }

  const EDGE=40;
  vp.addEventListener('scroll',()=>{
    if(vp.scrollTop + vp.clientHeight >= vp.scrollHeight - EDGE){
      appendNextYear();
    }
  },{passive:true});

  init();
})();
</script>

</body>
</html>